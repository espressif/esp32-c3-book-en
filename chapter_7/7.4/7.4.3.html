<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Exercise: Smart Wi-Fi Connection - ESP32-C3 Wireless Adventure</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A comprehensive guide to IoT">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../favicon.svg">
                        <link rel="shortcut icon" href="../../favicon.png">
                <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
                <link rel="stylesheet" href="../../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../../preface/authors_note.html">Author‚Äôs Note</a></li><li class="chapter-item expanded affix "><a href="../../preface/how_to_use.html">How to use this book?</a></li><li class="chapter-item expanded affix "><li class="part-title">Preparation</li><li class="chapter-item expanded "><a href="../../chapter_1/index.html"><strong aria-hidden="true">1.</strong> Introduction to IoT</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_1/1.1.html"><strong aria-hidden="true">1.1.</strong> Architecture of IoT</a></li><li class="chapter-item expanded "><a href="../../chapter_1/1.2.html"><strong aria-hidden="true">1.2.</strong> IoT Application in Smart Homes</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_2/index.html"><strong aria-hidden="true">2.</strong> Introduction and Practice of IoT Projects</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_2/2.1/index.html"><strong aria-hidden="true">2.1.</strong> Introduction to Typical IoT Projects</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_2/2.1/2.1.1.html"><strong aria-hidden="true">2.1.1.</strong> Basic Modules for Common IoT Devices</a></li><li class="chapter-item expanded "><a href="../../chapter_2/2.1/2.1.2.html"><strong aria-hidden="true">2.1.2.</strong> Basic Modules of Client Applications</a></li><li class="chapter-item expanded "><a href="../../chapter_2/2.1/2.1.3.html"><strong aria-hidden="true">2.1.3.</strong> Introduction to Common IoT Cloud Platforms</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_2/2.2/index.html"><strong aria-hidden="true">2.2.</strong> üßê Practice: Smart Light Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_2/2.2/2.2.1.html"><strong aria-hidden="true">2.2.1.</strong> Project Structure</a></li><li class="chapter-item expanded "><a href="../../chapter_2/2.2/2.2.2.html"><strong aria-hidden="true">2.2.2.</strong> Project Functions</a></li><li class="chapter-item expanded "><a href="../../chapter_2/2.2/2.2.3.html"><strong aria-hidden="true">2.2.3.</strong> Hardware Preparation</a></li><li class="chapter-item expanded "><a href="../../chapter_2/2.2/2.2.4.html"><strong aria-hidden="true">2.2.4.</strong> Development Process</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_2/summary.html"><strong aria-hidden="true">2.3.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_3/index.html"><strong aria-hidden="true">3.</strong> Introduction to ESP RainMaker</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_3/3.1.html"><strong aria-hidden="true">3.1.</strong> What is ESP RainMaker?</a></li><li class="chapter-item expanded "><a href="../../chapter_3/3.2/index.html"><strong aria-hidden="true">3.2.</strong> The Implementation of ESP RainMaker</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_3/3.2/3.2.1.html"><strong aria-hidden="true">3.2.1.</strong> Claiming Service</a></li><li class="chapter-item expanded "><a href="../../chapter_3/3.2/3.2.2.html"><strong aria-hidden="true">3.2.2.</strong> RainMaker Agent</a></li><li class="chapter-item expanded "><a href="../../chapter_3/3.2/3.2.3.html"><strong aria-hidden="true">3.2.3.</strong> Cloud Backend</a></li><li class="chapter-item expanded "><a href="../../chapter_3/3.2/3.2.4.html"><strong aria-hidden="true">3.2.4.</strong> RainMaker Client</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_3/3.3.html"><strong aria-hidden="true">3.3.</strong> üßê Practice: Key Points for Developing with ESP RainMaker</a></li><li class="chapter-item expanded "><a href="../../chapter_3/3.4/index.html"><strong aria-hidden="true">3.4.</strong> Features of ESP RainMaker</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_3/3.4/3.4.1.html"><strong aria-hidden="true">3.4.1.</strong> User Management</a></li><li class="chapter-item expanded "><a href="../../chapter_3/3.4/3.4.2.html"><strong aria-hidden="true">3.4.2.</strong> End User Features</a></li><li class="chapter-item expanded "><a href="../../chapter_3/3.4/3.4.3.html"><strong aria-hidden="true">3.4.3.</strong> Admin Features</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_3/summary.html"><strong aria-hidden="true">3.5.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_4/index.html"><strong aria-hidden="true">4.</strong> Setting Up Development Environment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_4/4.1/index.html"><strong aria-hidden="true">4.1.</strong> ESP-IDF Overview</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_4/4.1/4.1.1.html"><strong aria-hidden="true">4.1.1.</strong> ESP-IDF Versions</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.1/4.1.2.html"><strong aria-hidden="true">4.1.2.</strong> ESP-IDF Git Workflow</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.1/4.1.3.html"><strong aria-hidden="true">4.1.3.</strong> Choosing a Suitable Version</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.1/4.1.4.html"><strong aria-hidden="true">4.1.4.</strong> Overview of ESP-IDF SDK Directory</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_4/4.2/index.html"><strong aria-hidden="true">4.2.</strong> Setting Up ESP-IDF Development Environment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_4/4.2/4.2.1.html"><strong aria-hidden="true">4.2.1.</strong> Setting up ESP-IDF Development Environment on Linux</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.2/4.2.2.html"><strong aria-hidden="true">4.2.2.</strong> Setting up ESP-IDF Development Environment on Windows</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.2/4.2.3.html"><strong aria-hidden="true">4.2.3.</strong> Setting up ESP-IDF Development Environment on Mac</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.2/4.2.4.html"><strong aria-hidden="true">4.2.4.</strong> Installing VS Code</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.2/4.2.5.html"><strong aria-hidden="true">4.2.5.</strong> Introduction to Third-Party Development Environments</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_4/4.3/index.html"><strong aria-hidden="true">4.3.</strong> ESP-IDF Compilation System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_4/4.3/4.3.1.html"><strong aria-hidden="true">4.3.1.</strong> Basic Concepts of Compilation System</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.3/4.3.2.html"><strong aria-hidden="true">4.3.2.</strong> Project File Structure</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.3/4.3.3.html"><strong aria-hidden="true">4.3.3.</strong> Default Build Rules of the Compilation System</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.3/4.3.4.html"><strong aria-hidden="true">4.3.4.</strong> Introduction to the Compilation Script</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.3/4.3.5.html"><strong aria-hidden="true">4.3.5.</strong> Introduction to Common Commands</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_4/4.4/index.html"><strong aria-hidden="true">4.4.</strong> üßê Practice: Compiling Example Program ‚ÄúBlink‚Äù</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_4/4.4/4.4.1.html"><strong aria-hidden="true">4.4.1.</strong> Example Analysis</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.4/4.4.2.html"><strong aria-hidden="true">4.4.2.</strong> Compiling the Blink Program</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.4/4.4.3.html"><strong aria-hidden="true">4.4.3.</strong> Flashing the Blink Program</a></li><li class="chapter-item expanded "><a href="../../chapter_4/4.4/4.4.4.html"><strong aria-hidden="true">4.4.4.</strong> Serial Port Log Analysis of the Blink Program</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_4/summary.html"><strong aria-hidden="true">4.5.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Hardware and Driver Development</li><li class="chapter-item expanded "><a href="../../chapter_5/index.html"><strong aria-hidden="true">5.</strong> Hardware Design of Smart Light Products based on ESP32-C3</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_5/5.1.html"><strong aria-hidden="true">5.1.</strong> Features and Composition of Smart Light Products</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.2/index.html"><strong aria-hidden="true">5.2.</strong> Hardware Design of ESP32-C3 Core System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_5/5.2/5.2.1.html"><strong aria-hidden="true">5.2.1.</strong> Power Supply</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.2/5.2.2.html"><strong aria-hidden="true">5.2.2.</strong> Power-on Sequence and System Reset</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.2/5.2.3.html"><strong aria-hidden="true">5.2.3.</strong> SPI Flash</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.2/5.2.4.html"><strong aria-hidden="true">5.2.4.</strong> Clock Source</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.2/5.2.5.html"><strong aria-hidden="true">5.2.5.</strong> RF and Antenna</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.2/5.2.6.html"><strong aria-hidden="true">5.2.6.</strong> Strapping Pins</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.2/5.2.7.html"><strong aria-hidden="true">5.2.7.</strong> GPIO and PWM Controller</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_5/5.3/index.html"><strong aria-hidden="true">5.3.</strong> üßê Practice: Building a Smart Light System with ESP32-C3</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_5/5.3/5.3.1.html"><strong aria-hidden="true">5.3.1.</strong> Selecting Modules</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.3/5.3.2.html"><strong aria-hidden="true">5.3.2.</strong> Configuring GPIOs of PWM Signals</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.3/5.3.3.html"><strong aria-hidden="true">5.3.3.</strong> Downloading Firmware and Debugging Interface</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.3/5.3.4.html"><strong aria-hidden="true">5.3.4.</strong> Guidelines for RF Design</a></li><li class="chapter-item expanded "><a href="../../chapter_5/5.3/5.3.5.html"><strong aria-hidden="true">5.3.5.</strong> Guidelines for Power Supply Design</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_5/summary.html"><strong aria-hidden="true">5.4.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_6/index.html"><strong aria-hidden="true">6.</strong> Driver Development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_6/6.1.html"><strong aria-hidden="true">6.1.</strong> Driver Development Process</a></li><li class="chapter-item expanded "><a href="../../chapter_6/6.2.html"><strong aria-hidden="true">6.2.</strong> ESP32-C3 Peripheral Applications</a></li><li class="chapter-item expanded "><a href="../../chapter_6/6.3/index.html"><strong aria-hidden="true">6.3.</strong> LED Driver Basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_6/6.3/6.3.1.html"><strong aria-hidden="true">6.3.1.</strong> Color Spaces</a></li><li class="chapter-item expanded "><a href="../../chapter_6/6.3/6.3.2.html"><strong aria-hidden="true">6.3.2.</strong> LED Driver</a></li><li class="chapter-item expanded "><a href="../../chapter_6/6.3/6.3.3.html"><strong aria-hidden="true">6.3.3.</strong> LED Dimming</a></li><li class="chapter-item expanded "><a href="../../chapter_6/6.3/6.3.4.html"><strong aria-hidden="true">6.3.4.</strong> Introduction to PWM</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_6/6.4/index.html"><strong aria-hidden="true">6.4.</strong> LED Dimming Driver Development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_6/6.4/6.4.1.html"><strong aria-hidden="true">6.4.1.</strong> Non-Volatile Storage (NVS)</a></li><li class="chapter-item expanded "><a href="../../chapter_6/6.4/6.4.2.html"><strong aria-hidden="true">6.4.2.</strong> LED PWM Controller (LEDC)</a></li><li class="chapter-item expanded "><a href="../../chapter_6/6.4/6.4.3.html"><strong aria-hidden="true">6.4.3.</strong> LED PWM Programming</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_6/6.5/index.html"><strong aria-hidden="true">6.5.</strong> üßê Practice: Adding Drivers to Smart Light Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_6/6.5/6.5.1.html"><strong aria-hidden="true">6.5.1.</strong> Button Driver</a></li><li class="chapter-item expanded "><a href="../../chapter_6/6.5/6.5.2.html"><strong aria-hidden="true">6.5.2.</strong> LED Dimming Driver</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_6/summary.html"><strong aria-hidden="true">6.6.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Wireless Communication and Control</li><li class="chapter-item expanded "><a href="../../chapter_7/index.html"><strong aria-hidden="true">7.</strong> Wi-Fi Configuration and Connection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_7/7.1/index.html"><strong aria-hidden="true">7.1.</strong> Basics of Wi-Fi</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_7/7.1/7.1.1.html"><strong aria-hidden="true">7.1.1.</strong> Introduction to Wi-Fi</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.1/7.1.2.html"><strong aria-hidden="true">7.1.2.</strong> Evolution of IEEE 802.11</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.1/7.1.3.html"><strong aria-hidden="true">7.1.3.</strong> Wi-Fi Concepts</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.1/7.1.4.html"><strong aria-hidden="true">7.1.4.</strong> Wi-Fi Connection</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_7/7.2/index.html"><strong aria-hidden="true">7.2.</strong> Basics of Bluetooth</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_7/7.2/7.2.1.html"><strong aria-hidden="true">7.2.1.</strong> Introduction to Bluetooth</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.2/7.2.2.html"><strong aria-hidden="true">7.2.2.</strong> Bluetooth Concepts</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.2/7.2.3.html"><strong aria-hidden="true">7.2.3.</strong> Bluetooth Connection</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_7/7.3/index.html"><strong aria-hidden="true">7.3.</strong> Wi-Fi Network Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_7/7.3/7.3.1.html"><strong aria-hidden="true">7.3.1.</strong> Wi-Fi Network Configuration Guide</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.3/7.3.2.html"><strong aria-hidden="true">7.3.2.</strong> SoftAP</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.3/7.3.3.html"><strong aria-hidden="true">7.3.3.</strong> SmartConfig</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.3/7.3.4.html"><strong aria-hidden="true">7.3.4.</strong> Bluetooth</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.3/7.3.5.html"><strong aria-hidden="true">7.3.5.</strong> Other Methods</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_7/7.4/index.html"><strong aria-hidden="true">7.4.</strong> Wi-Fi Programming</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_7/7.4/7.4.1.html"><strong aria-hidden="true">7.4.1.</strong> Wi-Fi Components in ESP-IDF</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.4/7.4.2.html"><strong aria-hidden="true">7.4.2.</strong> Exercise: Wi-Fi Connection</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.4/7.4.3.html" class="active"><strong aria-hidden="true">7.4.3.</strong> Exercise: Smart Wi-Fi Connection</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_7/7.5/index.html"><strong aria-hidden="true">7.5.</strong> üßê Practice: Wi-Fi Configuration in Smart Light Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_7/7.5/7.5.1.html"><strong aria-hidden="true">7.5.1.</strong> Wi-Fi Connection in Smart Light Project</a></li><li class="chapter-item expanded "><a href="../../chapter_7/7.5/7.5.2.html"><strong aria-hidden="true">7.5.2.</strong> Smart Wi-Fi Configuration</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_7/summary.html"><strong aria-hidden="true">7.6.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_8/index.html"><strong aria-hidden="true">8.</strong> Local Control</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_8/8.1/index.html"><strong aria-hidden="true">8.1.</strong> Introduction to Local Control</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_8/8.1/8.1.1.html"><strong aria-hidden="true">8.1.1.</strong> Application of Local Control</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.1/8.1.2.html"><strong aria-hidden="true">8.1.2.</strong> Advantages of Local Control</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.1/8.1.3.html"><strong aria-hidden="true">8.1.3.</strong> Discovering Controlled Devices through Smartphones</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.1/8.1.4.html"><strong aria-hidden="true">8.1.4.</strong> Data Communication Between Smartphones and Devices</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_8/8.2/index.html"><strong aria-hidden="true">8.2.</strong> Common Local Discovery Methods</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_8/8.2/8.2.1.html"><strong aria-hidden="true">8.2.1.</strong> Broadcast</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.2/8.2.2.html"><strong aria-hidden="true">8.2.2.</strong> Multicast</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.2/8.2.3.html"><strong aria-hidden="true">8.2.3.</strong> Comparison Between Broadcast and Multicast</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.2/8.2.4.html"><strong aria-hidden="true">8.2.4.</strong> Multicast Application Protocol mDNS for Local Discovery</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_8/8.3/index.html"><strong aria-hidden="true">8.3.</strong> Common Communication Protocols for Local Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_8/8.3/8.3.1.html"><strong aria-hidden="true">8.3.1.</strong> Transmission Control Protocol (TCP)</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.3/8.3.2.html"><strong aria-hidden="true">8.3.2.</strong> HyperText Transfer Protocol (HTTP)</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.3/8.3.3.html"><strong aria-hidden="true">8.3.3.</strong> User Datagram Protocol (UDP)</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.3/8.3.4.html"><strong aria-hidden="true">8.3.4.</strong> Constrained Application Protocol (CoAP)</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.3/8.3.5.html"><strong aria-hidden="true">8.3.5.</strong> Bluetooth Protocol</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.3/8.3.6.html"><strong aria-hidden="true">8.3.6.</strong> Summary of Data Communication Protocols</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_8/8.4/index.html"><strong aria-hidden="true">8.4.</strong> Guarantee of Data Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_8/8.4/8.4.1.html"><strong aria-hidden="true">8.4.1.</strong> Introduction to Transport Layer Security (TLS)</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.4/8.4.2.html"><strong aria-hidden="true">8.4.2.</strong> Introduction to Datagram Transport Layer Security (DTLS)</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_8/8.5/index.html"><strong aria-hidden="true">8.5.</strong> üßê Practice: Local Control in Smart Light Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_8/8.5/8.5.1.html"><strong aria-hidden="true">8.5.1.</strong> Creating a Wi-Fi-based Local Control Server</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.5/8.5.2.html"><strong aria-hidden="true">8.5.2.</strong> Verifying Local Control Functionality using Scripts</a></li><li class="chapter-item expanded "><a href="../../chapter_8/8.5/8.5.3.html"><strong aria-hidden="true">8.5.3.</strong> Creating a Bluetooth-based Local Control Server</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_8/summary.html"><strong aria-hidden="true">8.6.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_9/index.html"><strong aria-hidden="true">9.</strong> Cloud Control</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_9/9.1.html"><strong aria-hidden="true">9.1.</strong> Introduction to Remote Control</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.2/index.html"><strong aria-hidden="true">9.2.</strong> Cloud Data Communication Protocols</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_9/9.2/9.2.1.html"><strong aria-hidden="true">9.2.1.</strong> MQTT Introduction</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.2/9.2.2.html"><strong aria-hidden="true">9.2.2.</strong> MQTT Principles</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.2/9.2.3.html"><strong aria-hidden="true">9.2.3.</strong> MQTT Message Format</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.2/9.2.4.html"><strong aria-hidden="true">9.2.4.</strong> Protocol Comparison</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.2/9.2.5.html"><strong aria-hidden="true">9.2.5.</strong> Setting Up MQTT Broker on Linux and Windows</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.2/9.2.6.html"><strong aria-hidden="true">9.2.6.</strong> Setting Up MQTT Client Based on ESP-IDF</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_9/9.3/index.html"><strong aria-hidden="true">9.3.</strong> Ensuring MQTT Data Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_9/9.3/9.3.1.html"><strong aria-hidden="true">9.3.1.</strong> Meaning and Function of Certificates</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.3/9.3.2.html"><strong aria-hidden="true">9.3.2.</strong> Generating Certificates Locally</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.3/9.3.3.html"><strong aria-hidden="true">9.3.3.</strong> Configuring MQTT Broker</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.3/9.3.4.html"><strong aria-hidden="true">9.3.4.</strong> Configuring MQTT Client</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_9/9.4/index.html"><strong aria-hidden="true">9.4.</strong> üßê Practice: Remote Control through ESP RainMaker</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_9/9.4/9.4.1.html"><strong aria-hidden="true">9.4.1.</strong> ESP RainMaker Basics</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.4/9.4.2.html"><strong aria-hidden="true">9.4.2.</strong> Node and Cloud Backend Communication Protocol</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.4/9.4.3.html"><strong aria-hidden="true">9.4.3.</strong> Communication between Client and Cloud Backend</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.4/9.4.4.html"><strong aria-hidden="true">9.4.4.</strong> User Roles</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.4/9.4.5.html"><strong aria-hidden="true">9.4.5.</strong> Basic Services</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.4/9.4.6.html"><strong aria-hidden="true">9.4.6.</strong> Smart Light Example</a></li><li class="chapter-item expanded "><a href="../../chapter_9/9.4/9.4.7.html"><strong aria-hidden="true">9.4.7.</strong> RainMaker App and Third-Party Integrations</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_9/summary.html"><strong aria-hidden="true">9.5.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_10/index.html"><strong aria-hidden="true">10.</strong> Smartphone App Development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_10/10.1/index.html"><strong aria-hidden="true">10.1.</strong> Introduction to Smartphone App Development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_10/10.1/10.1.1.html"><strong aria-hidden="true">10.1.1.</strong> Overview of Smartphone App Development</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.1/10.1.2.html"><strong aria-hidden="true">10.1.2.</strong> Structure of the Android Project</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.1/10.1.3.html"><strong aria-hidden="true">10.1.3.</strong> Structure of the iOS Project</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.1/10.1.4.html"><strong aria-hidden="true">10.1.4.</strong> Lifecycle of an Android Activity</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.1/10.1.5.html"><strong aria-hidden="true">10.1.5.</strong> Lifecycle of iOS ViewController</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_10/10.2/index.html"><strong aria-hidden="true">10.2.</strong> Creating a New Smartphone App Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_10/10.2/10.2.1.html"><strong aria-hidden="true">10.2.1.</strong> Preparing for Android Development</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.2/10.2.2.html"><strong aria-hidden="true">10.2.2.</strong> Creating a New Android Project</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.2/10.2.3.html"><strong aria-hidden="true">10.2.3.</strong> Adding Dependencies for MyRainmaker</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.2/10.2.4.html"><strong aria-hidden="true">10.2.4.</strong> Permission Request in Android</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.2/10.2.5.html"><strong aria-hidden="true">10.2.5.</strong> Preparing for iOS Development</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.2/10.2.6.html"><strong aria-hidden="true">10.2.6.</strong> Creating a New iOS Project</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.2/10.2.7.html"><strong aria-hidden="true">10.2.7.</strong> Adding Dependencies for MyRainmaker</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.2/10.2.8.html"><strong aria-hidden="true">10.2.8.</strong> Permission Request in iOS</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_10/10.3/index.html"><strong aria-hidden="true">10.3.</strong> Analysis of the App‚Äôs Functional Requirements</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_10/10.3/10.3.1.html"><strong aria-hidden="true">10.3.1.</strong> Analysis of the Project‚Äôs Functional Requirements</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.3/10.3.2.html"><strong aria-hidden="true">10.3.2.</strong> Analysis of User Management Requirements</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.3/10.3.3.html"><strong aria-hidden="true">10.3.3.</strong> Analysis of Device Provisioning and Binding Requirements</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.3/10.3.4.html"><strong aria-hidden="true">10.3.4.</strong> Analysis of Remote-Control Requirements</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.3/10.3.5.html"><strong aria-hidden="true">10.3.5.</strong> Analysis of Scheduling Requirements</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.3/10.3.6.html"><strong aria-hidden="true">10.3.6.</strong> Analysis of User Center Requirements</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_10/10.4/index.html"><strong aria-hidden="true">10.4.</strong> Development of User Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_10/10.4/10.4.1.html"><strong aria-hidden="true">10.4.1.</strong> Introduction to RainMaker APIs</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.4/10.4.2.html"><strong aria-hidden="true">10.4.2.</strong> Initiating Communication via Smartphone</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.4/10.4.3.html"><strong aria-hidden="true">10.4.3.</strong> Account Registration</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.4/10.4.4.html"><strong aria-hidden="true">10.4.4.</strong> Account Login</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_10/10.5/index.html"><strong aria-hidden="true">10.5.</strong> Development of Device Provisioning</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_10/10.5/10.5.1.html"><strong aria-hidden="true">10.5.1.</strong> Scanning Devices</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.5/10.5.2.html"><strong aria-hidden="true">10.5.2.</strong> Connecting Devices</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.5/10.5.3.html"><strong aria-hidden="true">10.5.3.</strong> Generating Secret Keys</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.5/10.5.4.html"><strong aria-hidden="true">10.5.4.</strong> Getting Node ID</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.5/10.5.5.html"><strong aria-hidden="true">10.5.5.</strong> Provisioning Devices</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_10/10.6/index.html"><strong aria-hidden="true">10.6.</strong> Development of Device Control</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_10/10.6/10.6.1.html"><strong aria-hidden="true">10.6.1.</strong> Binding Devices to Cloud Accounts</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.6/10.6.2.html"><strong aria-hidden="true">10.6.2.</strong> Getting a List of Devices</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.6/10.6.3.html"><strong aria-hidden="true">10.6.3.</strong> Getting Device Status</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.6/10.6.4.html"><strong aria-hidden="true">10.6.4.</strong> Changing Device Status</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_10/10.7/index.html"><strong aria-hidden="true">10.7.</strong> Development of Scheduling and User Center</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_10/10.7/10.7.1.html"><strong aria-hidden="true">10.7.1.</strong> Implementing Scheduling Function</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.7/10.7.2.html"><strong aria-hidden="true">10.7.2.</strong> Implementing User Center</a></li><li class="chapter-item expanded "><a href="../../chapter_10/10.7/10.7.3.html"><strong aria-hidden="true">10.7.3.</strong> More Cloud APIs</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_10/summary.html"><strong aria-hidden="true">10.8.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_11/index.html"><strong aria-hidden="true">11.</strong> Firmware Upgrade and Version Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_11/11.1/index.html"><strong aria-hidden="true">11.1.</strong> Firmware Upgrade</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_11/11.1/11.1.1.html"><strong aria-hidden="true">11.1.1.</strong> Overview of Partition Tables</a></li><li class="chapter-item expanded "><a href="../../chapter_11/11.1/11.1.2.html"><strong aria-hidden="true">11.1.2.</strong> Firmware Boot Process</a></li><li class="chapter-item expanded "><a href="../../chapter_11/11.1/11.1.3.html"><strong aria-hidden="true">11.1.3.</strong> Overview of the OTA Mechanism</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_11/11.2/index.html"><strong aria-hidden="true">11.2.</strong> Firmware Version Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_11/11.2/11.2.1.html"><strong aria-hidden="true">11.2.1.</strong> Firmware Marking</a></li><li class="chapter-item expanded "><a href="../../chapter_11/11.2/11.2.2.html"><strong aria-hidden="true">11.2.2.</strong> Rollback and Anti-Rollback</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_11/11.3/index.html"><strong aria-hidden="true">11.3.</strong> üßê Practice: Over-the-air (OTA) Example</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_11/11.3/11.3.1.html"><strong aria-hidden="true">11.3.1.</strong> Upgrade Firmware Through a Local Host</a></li><li class="chapter-item expanded "><a href="../../chapter_11/11.3/11.3.2.html"><strong aria-hidden="true">11.3.2.</strong> Upgrade Firmware Through ESP RainMaker</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_11/summary.html"><strong aria-hidden="true">11.4.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Optimisation and Mass Production</li><li class="chapter-item expanded "><a href="../../chapter_12/index.html"><strong aria-hidden="true">12.</strong> Power Management and Low-Power Optimisation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_12/12.1/index.html"><strong aria-hidden="true">12.1.</strong> ESP32-C3 Power Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_12/12.1/12.1.1.html"><strong aria-hidden="true">12.1.1.</strong> Dynamic Frequency Scaling</a></li><li class="chapter-item expanded "><a href="../../chapter_12/12.1/12.1.2.html"><strong aria-hidden="true">12.1.2.</strong> Power Management Configuration</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_12/12.2/index.html"><strong aria-hidden="true">12.2.</strong> ESP32-C3 Low-Power Mode</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_12/12.2/12.2.1.html"><strong aria-hidden="true">12.2.1.</strong> Modem-sleep mode</a></li><li class="chapter-item expanded "><a href="../../chapter_12/12.2/12.2.2.html"><strong aria-hidden="true">12.2.2.</strong> Light-sleep Mode</a></li><li class="chapter-item expanded "><a href="../../chapter_12/12.2/12.2.3.html"><strong aria-hidden="true">12.2.3.</strong> Deep-sleep mode</a></li><li class="chapter-item expanded "><a href="../../chapter_12/12.2/12.2.4.html"><strong aria-hidden="true">12.2.4.</strong> Current Consumption in Different Power Modes</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_12/12.3/index.html"><strong aria-hidden="true">12.3.</strong> Power Management and Low-Power Debugging</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_12/12.3/12.3.1.html"><strong aria-hidden="true">12.3.1.</strong> Log Debugging</a></li><li class="chapter-item expanded "><a href="../../chapter_12/12.3/12.3.2.html"><strong aria-hidden="true">12.3.2.</strong> GPIO Debugging</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_12/12.4/index.html"><strong aria-hidden="true">12.4.</strong> Practice: Power Management in Smart Light Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_12/12.4/12.4.1.html"><strong aria-hidden="true">12.4.1.</strong> Configuring Power Management Feature</a></li><li class="chapter-item expanded "><a href="../../chapter_12/12.4/12.4.2.html"><strong aria-hidden="true">12.4.2.</strong> Use Power Management Locks</a></li><li class="chapter-item expanded "><a href="../../chapter_12/12.4/12.4.3.html"><strong aria-hidden="true">12.4.3.</strong> Verifying Power Consumption</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_12/summary.html"><strong aria-hidden="true">12.5.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_13/index.html"><strong aria-hidden="true">13.</strong> Enhanced Device Security Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_13/13.1/index.html"><strong aria-hidden="true">13.1.</strong> Overview of IoT Device Data Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_13/13.1/13.1.1.html"><strong aria-hidden="true">13.1.1.</strong> Why Securing IoT Device Data?</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.1/13.1.2.html"><strong aria-hidden="true">13.1.2.</strong> Basic Requirements for IoT Device Data Security</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_13/13.2/index.html"><strong aria-hidden="true">13.2.</strong> Data Integrity Protection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_13/13.2/13.2.1.html"><strong aria-hidden="true">13.2.1.</strong> Introduction to Integrity Verification Method</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.2/13.2.2.html"><strong aria-hidden="true">13.2.2.</strong> Integrity Verification of Firmware Data</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.2/13.2.3.html"><strong aria-hidden="true">13.2.3.</strong> Example</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_13/13.3/index.html"><strong aria-hidden="true">13.3.</strong> Data Confidentiality Protection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_13/13.3/13.3.1.html"><strong aria-hidden="true">13.3.1.</strong> Introduction to Data Encryption</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.3/13.3.2.html"><strong aria-hidden="true">13.3.2.</strong> Introduction to Flash Encryption Scheme</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.3/13.3.3.html"><strong aria-hidden="true">13.3.3.</strong> Flash Encryption Key Storage</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.3/13.3.4.html"><strong aria-hidden="true">13.3.4.</strong> Working Mode of Flash Encryption</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.3/13.3.5.html"><strong aria-hidden="true">13.3.5.</strong> Flash Encryption Process</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.3/13.3.6.html"><strong aria-hidden="true">13.3.6.</strong> Introduction to NVS Encryption</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.3/13.3.7.html"><strong aria-hidden="true">13.3.7.</strong> Examples of Flash Encryption and NVS Encryption</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_13/13.4/index.html"><strong aria-hidden="true">13.4.</strong> Data Legitimacy Protection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_13/13.4/13.4.1.html"><strong aria-hidden="true">13.4.1.</strong> Introduction to Digital Signature</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.4/13.4.2.html"><strong aria-hidden="true">13.4.2.</strong> Overview of Secure Boot Scheme</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.4/13.4.3.html"><strong aria-hidden="true">13.4.3.</strong> Introduction to Software Secure Boot</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.4/13.4.4.html"><strong aria-hidden="true">13.4.4.</strong> Introduction to Hardware Secure Boot</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.4/13.4.5.html"><strong aria-hidden="true">13.4.5.</strong> Examples</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_13/13.5/index.html"><strong aria-hidden="true">13.5.</strong> Practice: Security Features In Mass Production</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_13/13.5/13.5.1.html"><strong aria-hidden="true">13.5.1.</strong> Flash Encryption and Secure Boot</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.5/13.5.2.html"><strong aria-hidden="true">13.5.2.</strong> Enabling Flash Encryption and Secure Boot with Batch Flash Tools</a></li><li class="chapter-item expanded "><a href="../../chapter_13/13.5/13.5.3.html"><strong aria-hidden="true">13.5.3.</strong> Enabling Flash Encryption and Secure Boot in Smart Light Project</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_13/summary.html"><strong aria-hidden="true">13.6.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_14/index.html"><strong aria-hidden="true">14.</strong> Firmware Burning and Testing for Mass Production</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_14/14.1/index.html"><strong aria-hidden="true">14.1.</strong> Firmware Burning in Mass Production</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_14/14.1/14.1.1.html"><strong aria-hidden="true">14.1.1.</strong> Defining Data Partitions</a></li><li class="chapter-item expanded "><a href="../../chapter_14/14.1/14.1.2.html"><strong aria-hidden="true">14.1.2.</strong> Firmware Burning</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_14/14.2.html"><strong aria-hidden="true">14.2.</strong> Mass Production Testing</a></li><li class="chapter-item expanded "><a href="../../chapter_14/14.3.html"><strong aria-hidden="true">14.3.</strong> Practice: Mass Production Data in Smart Light Project</a></li><li class="chapter-item expanded "><a href="../../chapter_14/summary.html"><strong aria-hidden="true">14.4.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_15/index.html"><strong aria-hidden="true">15.</strong> ESP Insights: Remote Monitoring Platform</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_15/15.1.html"><strong aria-hidden="true">15.1.</strong> Introduction to ESP Insights</a></li><li class="chapter-item expanded "><a href="../../chapter_15/15.2/index.html"><strong aria-hidden="true">15.2.</strong> Getting Started with ESP Insights</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../chapter_15/15.2/15.2.1.html"><strong aria-hidden="true">15.2.1.</strong> Getting Started with ESP Insights in the esp-insights Project</a></li><li class="chapter-item expanded "><a href="../../chapter_15/15.2/15.2.2.html"><strong aria-hidden="true">15.2.2.</strong> Running Example in the esp-insights Project</a></li><li class="chapter-item expanded "><a href="../../chapter_15/15.2/15.2.3.html"><strong aria-hidden="true">15.2.3.</strong> Reporting Coredump Information</a></li><li class="chapter-item expanded "><a href="../../chapter_15/15.2/15.2.4.html"><strong aria-hidden="true">15.2.4.</strong> Customising Logs of Interest</a></li><li class="chapter-item expanded "><a href="../../chapter_15/15.2/15.2.5.html"><strong aria-hidden="true">15.2.5.</strong> Reporting Reboot Reason</a></li><li class="chapter-item expanded "><a href="../../chapter_15/15.2/15.2.6.html"><strong aria-hidden="true">15.2.6.</strong> Reporting Custom Metrics</a></li></ol></li><li class="chapter-item expanded "><a href="../../chapter_15/15.3.html"><strong aria-hidden="true">15.3.</strong> Practice: Using ESP Insights in Smart Light Project</a></li><li class="chapter-item expanded "><a href="../../chapter_15/summary.html"><strong aria-hidden="true">15.4.</strong> Summary</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">ESP32-C3 Wireless Adventure</h1>

                    <div class="right-buttons">
                                                <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/esp-rs/book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                                        <a href="https://github.com/espressif/esp32-c3-book-en/blob/main/WRITINGS.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="exercise-smart-wi-fi-connection"><a class="header" href="#exercise-smart-wi-fi-connection">Exercise: Smart Wi-Fi Connection</a></h1>
<h2 id="-softap"><a class="header" href="#-softap">üí° SoftAP</a></h2>
<p>The <code>wifi_provisioning</code> components provided by ESP32-C3 can transmit
SSID and password of the AP through SoftAP or Bluetooth LE, and then use
them to connect to the AP.</p>
<h3 id="apis"><a class="header" href="#apis">APIs</a></h3>
<p>The APIs for <code>wifi_provisioning</code> are defined in <a href="https://github.com/espressif/esp-idf/blob/master/components/wifi_provisioning/include/wifi_provisioning/manager.h"><code>esp-idf/components/wifi_provi sioning/include/wifi_provisioning/manager.h</code></a>, as shown in Table 7.4.</p>
<p align="center"><i>Table 7.4. APIs for <code>wifi_provisioning</code> components</i></p>
<table><thead><tr><th>API</th><th>Description</th></tr></thead><tbody>
<tr><td><code>wifi_prov_mgr_init()</code></td><td>Initialise <code>provisioning</code> manager interface according to current configuration</td></tr>
<tr><td><code>wifi_prov_mgr_deinit()</code></td><td>Release <code>provisioning</code> manager interface</td></tr>
<tr><td><code>wifi_prov_mgr_is_provisioned()</code></td><td>Check the <code>provisioning</code> status of ESP32-C3</td></tr>
<tr><td><code>wifi_prov_mgr_start_provisioning()</code></td><td>Start the <code>provisioning</code> service</td></tr>
<tr><td><code>wifi_prov_mgr_stop_provisioning()</code></td><td>Stop the <code>provisioning</code> service</td></tr>
<tr><td><code>wifi_prov_mgr_wait()</code></td><td>Wait for the <code>provisioning</code> service to finish</td></tr>
<tr><td><code>wifi_prov_mgr_disable_auto_stop()</code></td><td>Disable auto stopping of the <code>provisioning</code> service upon completion</td></tr>
<tr><td><code>wifi_prov_mgr_endpoint_create()</code></td><td>Create an <code>endpoint</code> and allocate internal resources for it</td></tr>
<tr><td><code>wifi_prov_mgr_endpoint_register()</code></td><td>Register a handler for the created <code>endpoint</code></td></tr>
<tr><td><code>wifi_prov_mgr_endpoint_unregister()</code></td><td>Unregister the handler for the created <code>endpoint</code></td></tr>
<tr><td><code>wifi_prov_mgr_get_wifi_state()</code></td><td>Get the state of the Wi-Fi STA during <code>provisioning</code></td></tr>
<tr><td><code>wifi_prov_mgr_get_wifi_disconnect_reason()</code></td><td>Get the reason code for Wi-Fi STA disconnection during <code>provisioning</code></td></tr>
</tbody></table>
<h3 id="program-structure"><a class="header" href="#program-structure">Program structure</a></h3>
<ul>
<li>
<p>Initialisation:</p>
<pre><code class="language-c">wifi_prov_mgr_config_t config = {
    .scheme = wifi_prov_scheme_softap,
    .scheme_event_handler = WIFI_PROV_EVENT_HANDLER_NONE
};

ESP_ERR_CHECK(wifi_prov_mgr_init(config));
</code></pre>
</li>
<li>
<p>Checking the <code>provisioning</code> status:</p>
<pre><code class="language-c">bool provisioned = false;
ESP_ERROR_CHECK(wifi_prov_mgr_is_provisioned(&amp;provisioned));
</code></pre>
</li>
<li>
<p>Starting <code>provisioning</code> service:</p>
<pre><code class="language-c">const char *service_name = &quot;my_device&quot;;
const char *service_key  = &quot;password&quot;;

wifi_prov_security_t security = WIFI_PROV_SECURITY_1;
const char *pop = &quot;abcd1234&quot;;

ESP_ERR_CHECK(wifi_prov_mgr_start_provisioning(security, pop, service_name, service_key));
</code></pre>
</li>
<li>
<p>Releasing resources for <code>provisioning</code>.</p>
<p>Once the <code>provisioning</code> service is complete, the main application will
release the resources for <code>provisioning</code> and start executing its own
logic. There are two ways to do this. The simpler way is to call
<code>wifi_prov_mgr_wait()</code>. See the code below:</p>
<pre><code class="language-c">//Wait for the provisioning service to finish
wifi_prov_mgr_wait();

//Release the resources for provisioning
wifi_prov_mgr_deinit();
</code></pre>
<p>The other way is to use the callback function of the event. See the code
below:</p>
<pre><code class="language-c">static void event_handler(void* arg, esp_event_base_t event_base,
                        int event_id, void* event_data)
{
    if (event_base == WIFI_PROV_EVENT &amp;&amp; event_id == WIFI_PROV_END) {
        //Release the resources for provisioning upon completion
        wifi_prov_mgr_deinit();
    }
}
</code></pre>
</li>
</ul>
<h3 id="functional-verification"><a class="header" href="#functional-verification">Functional verification</a></h3>
<p>To get started, install ESP SoftAP Provisioning on your phone. Next,
turn on the Wi-Fi and power on the device. Ensure that the output log by
the serial port (see Figure 7.34) contains information beginning with
<code>PROV_</code>.</p>
<blockquote>
<p>üìå <strong>Tip</strong></p>
<p>You may download the APP at <a href="https://www.espressif.com/en/support/download/apps">https://www.espressif.com/en/support/download/apps</a>.</p>
</blockquote>
<figure align="center">
    <img src="../../Pics/D7Z/7-34.png" width="80%">
    <figcaption>Figure 7.34. Output log by the serial port</figcaption>
</figure>
<ol>
<li>
<p><strong>Startup</strong></p>
<p>Open the application on your phone and tap &quot;Start Provisioning&quot;. Then
you will find the device PROV_DAED2CXXXXX on the screen (refer to Figure
7.35).</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-35.png" width="50%">
    <figcaption>Figure 7.35. Startup</figcaption>
</figure>
</li>
<li>
<p><strong>Connection</strong></p>
<p>Tap &quot;Connect&quot; to navigate to the Wi-Fi setting interface. Select to
connect the device PROV_DAED2CXXXXX. If connected, you will see the
screen as Figure 7.36.</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-36.png" width="50%">
    <figcaption>Figure 7.36. SoftAP connection</figcaption>
</figure>
<p>The output log is as follows:</p>
<pre><code class="language-shell">I (102906) wifi:station: 88:40:3b:40:c1:13 join, AID=1, bgn, 40U
I (103056) esp_netif_lwip: DHCP server assigned IP to a station, IP is: 192.168.4.2
I (124286) wifi:station: 88:40:3b:40:c1:13 leave, AID = 1, bss_flags is 134259, bss:0x3fca7844
I (124286) wifi:new: &lt;1,0&gt;, old: &lt;1,1&gt;, ap: &lt;1,1&gt;, sta: &lt;0,0&gt;, prof:1
I (149036) wifi:new: &lt;1,1&gt;, old: &lt;1,0&gt;, ap: &lt;1,1&gt;, sta: &lt;0,0&gt;, prof:1
I (149036) wifi:station: 88:40:3b:40:c1:13 join, AID=1, bgn, 40U
I (149246) esp_netif_lwip: DHCP server assigned IP to a station, IP is: 192.168.4.2
</code></pre>
</li>
<li>
<p><strong>Provisioning</strong></p>
<p>Tap &quot;Provision Network&quot; to enter the provisioning screen shown in Figure
7.37.</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-37.png" width="50%">
    <figcaption>Figure 7.37. Provisioning</figcaption>
</figure>
</li>
<li>
<p><strong>Completion</strong></p>
<p>Tap &quot;Provision&quot; to enter the completion screen shown in Figure 7.38.</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-38.png" width="50%">
    <figcaption>Figure 7.38. Completion</figcaption>
</figure>
<p>The output log is as follows:</p>
<pre><code class="language-shell">I (139471) app: Received Wi-Fi credentials
          SSID     : myssid
          Password : mypassword
          .
          .
          .
I (144091) app: Connected with IP Address:192.168.50.31
I (144091) esp_netif_handlers: sta ip: 192.168.50.31, mask: 255.255.255.0, gw: 192.168.50.1
I (144091) wifi_prov_mgr: STA Got IP
I (144101) app: provisioningsuccessful
I (144101) app: Hello World!
I (145101) app: Hello World!
          .
          .
          .
I (146091) wifi_prov_mgr: Provisioning stopped
I (146101) app: Hello World!
I (147101) app: Hello World!
I (148101) app: Hello World!
</code></pre>
</li>
</ol>
<h2 id="-smartconfig"><a class="header" href="#-smartconfig">üí° SmartConfig</a></h2>
<p>The SmartConfig component provided by ESP32-C3 can transmit the SSID and
password of the AP through promiscuous mode, and then use them to
connect to the AP.</p>
<h3 id="apis-1"><a class="header" href="#apis-1">APIs</a></h3>
<p>The APIs for SmartConfig are defined in <a href="https://github.com/espressif/esp-idf/blob/master/components/esp_wifi/include/esp_smartconfig.h"><code>esp-idf/components/esp_wifi/include/ esp_smartconfig.h</code></a>, as shown in Table 7.5.</p>
<p align="center"><i>Table 7.5. APIs for SmartConfig</i></p>
<table><thead><tr><th>API</th><th>Description</th></tr></thead><tbody>
<tr><td><code>esp_smartconfig_get_version()</code></td><td>Get the version of the current SmartConfig</td></tr>
<tr><td><code>esp_smartconfig_start()</code></td><td>Start SmartConfig</td></tr>
<tr><td><code>esp_smartconfig_stop()</code></td><td>Stop SmartConfig</td></tr>
<tr><td><code>esp_esptouch_set_timeout()</code></td><td>Set the timeout of SmartConfig process</td></tr>
<tr><td><code>esp_smartconfig_set_type()</code></td><td>Set the protocol type of SmartConfig</td></tr>
<tr><td><code>esp_smartconfig_fast_mode()</code></td><td>Set the mode of SmartConfig</td></tr>
<tr><td><code>esp_smartconfig_get_rvd_data()</code></td><td>Get the reserved data of ESPTouch v2</td></tr>
</tbody></table>
<h3 id="program-structure-1"><a class="header" href="#program-structure-1">Program structure</a></h3>
<ul>
<li>
<p>Wi-Fi event handling</p>
<p>This module takes care of Wi-Fi connection, disconnection, reconnection,
scanning, etc., as detailed in the sections before. Additionally, when
the <code>WIFI_EVENT_STA_START</code> event occurs, it will also create a
SmartConfig task.</p>
</li>
<li>
<p>NETIF event handling</p>
<p>This module helps acquire the IP address. Details are provided in the
sections before. When the <code>IP_EVENT_STA_GOT_IP</code> event occurs, the
connection flag will be set.</p>
</li>
<li>
<p>SmartConfig event handling</p>
<p>The received request determines how the event is handled and processed.
SmartConfig events are shown in Table 7.6.</p>
<p align="center"><i>Table 7.6. SmartConfig events</i></p>
<table><thead><tr><th>Event</th><th>Description</th></tr></thead><tbody>
<tr><td><code>SC_EVENT_SCAN_DONE</code></td><td>Scan to obtain the information about nearby APs</td></tr>
<tr><td><code>SC_EVENT_FOUND_CHANNEL</code></td><td>Get the channel of the target AP</td></tr>
<tr><td><code>SC_EVENT_GOT_SSID_PSWD</code></td><td>Enter STA mode to get the SSID and password of the target AP</td></tr>
<tr><td><code>SC_EVENT_SEND_ACK_DONE</code></td><td>Set the SmartConfig completion flag</td></tr>
</tbody></table>
</li>
<li>
<p>SmartConfig tasks</p>
<p>The code for SmartConfig tasks is as follows.</p>
<pre><code class="language-c">static void smartconfig_example_task (void *param)
{
    EventBits_t uxBits;
    ESP_ERROR_CHECK(esp_smartconfig_set_type(SC_TYPE_ESPTOUCH));
    smartconfig_start_config_t cfg = SMARTCONFIG_START_CONFIG_DEFAULT();
    ESP_ERROR_CHECK(esp_smartconfig_start(&amp;cfg));
    while (1) {
        uxBits = xEventGroupWaitBits (s_wifi_event_group,
                                    CONNECTED_BIT | ESPTOUCH_DONE_BIT,
                                    true,
                                    false,
                                    portMAX_DELAY);
        if (uxBits &amp; CONNECTED_BIT) {
            ESP_LOGI (TAG, &quot;WiFi Connected to ap&quot;);
        }
        if (uxBits &amp; ESPTOUCH_DONE_BIT) {
            ESP_LOGI (TAG, &quot;smartconfig over&quot;);
            esp_smartconfig_stop();
            vTaskDelete (NULL);
        }
    }
}
</code></pre>
<p>As demonstrated in the code above, a SmartConfig task primarily performs
three functions. First, it sets the SmartConfig type, such as ESP-TOUCH
and ESP-TOUCH V2. Second, after the configuration, it enables
SmartConfig by calling <code>esp_smartconfig_start()</code>. Finally, it checks the
event group in a loop. Upon receiving the <code>SC_EVENT_SEND_ACK_DONE</code>
event, it stops SmartConfig by calling <code>esp_smartconfig_stop()</code>.</p>
</li>
<li>
<p>Main program</p>
<p>It creates an event group to set the flag when a relevant event is
triggered, and then initialises Wi-Fi.</p>
</li>
</ul>
<h3 id="functional-verification-1"><a class="header" href="#functional-verification-1">Functional verification</a></h3>
<p>To get started, install Espressif Esptouch on your phone. Then turn on
the Wi-Fi and power on the device. You will see the output log by the
serial port as follows:</p>
<pre><code class="language-shell">I (1084) wifi:mode : sta (30:ae:a4:80:65:7c)
I (1084) wifi:enable tsf
I (1134) smartconfig: SC version: V3.0.1
I (5234) wifi:ic_enable_sniffer
I (5234) smartconfig: Start to find channel...
I (5234) smartconfig_example: Scan done
</code></pre>
<blockquote>
<p>üìå  <strong>Tip</strong></p>
<p>You may download the APP at <a href="https://www.espressif.com/en/support/download/apps">https://www.espressif.com/en/support/download/apps</a>.</p>
</blockquote>
<p>Connect your phone to Wi-Fi, and enter the password to start
configuration. The SmartConfig interface is shown in Figure 7.39.</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-39.png" width="40%">
    <figcaption>Figure 7.39. SmartConfig configuration</figcaption>
</figure>
<p>The output log is as follows:</p>
<pre><code class="language-shell">I (234592) smartconfig: TYPE: ESPTOUCH
I (234592) smartconfig: T|PHONE MAC:68:3e:34:88:59:bf
I (234592) smartconfig: T|AP MAC:a4:56:02:47:30:07
I (234592) sc: SC_STATUS_GETTING_SSID_PSWD
I (239922) smartconfig: T|pswd: 123456789
I (239922) smartconfig: T|ssid: IOT_DEMO_TEST
I (239922) smartconfig: T|bssid: a4:56:02:47:30:07
I (239922) wifi: ic_disable_sniffer
I (239922) sc: SC_STATUS_LINK
I (239932) sc: SSID:IOT_DEMO_TEST
I (239932) sc: PASSWORD:123456789
I (240062) wifi: n:1 0, o:1 0, ap:255 255, sta:1 0, prof:1
I (241042) wifi: state: init -&gt; auth (b0)
I (241042) wifi: state: auth -&gt; assoc (0)
I (241052) wifi: state: assoc -&gt; run (10)
I (241102) wifi: connected with IOT_DEMO_TEST, channel 1
I (244892) event: ip: 192.168.0.152, mask: 255.255.255.0, gw: 192.168.0.1
I (244892) sc: WiFi Connected to ap
I (247952) sc: SC_STATUS_LINK_OVER
I (247952) sc: Phone ip: 192.168.0.31
I (247952) sc: smartconfig over
</code></pre>
<h2 id="-bluetooth"><a class="header" href="#-bluetooth">üí° Bluetooth</a></h2>
<p>The BluFi components of ESP32-C3 help transmit the SSID and password
through Bluetooth LE, which can be used to connect to the AP.</p>
<h3 id="apis-2"><a class="header" href="#apis-2">APIs</a></h3>
<p>The APIs for BluFi components are defined in <a href="https://github.com/espressif/esp-idf/blob/master/components/bt/common/api/include/api/esp_blufi_api.h"><code>esp_blufi_api.h</code></a>, as shown in Table 7.7.</p>
<p align="center"><i>Table 7.7. APIs for BluFi components</i></p>
<table><thead><tr><th>API</th><th>Description</th></tr></thead><tbody>
<tr><td><code>esp_blufi_register_callbacks()</code></td><td>Register BluFi callback events</td></tr>
<tr><td><code>esp_blufi_profile_init()</code></td><td>Initialise BluFi profile</td></tr>
<tr><td><code>esp_blufi_profile_deinit()</code></td><td>Deinitialise BluFi profile</td></tr>
<tr><td><code>esp_blufi_send_wifi_conn_report()</code></td><td>Send Wi-Fi connection reports</td></tr>
<tr><td><code>esp_blufi_send_wifi_list()</code></td><td>Send the Wi-Fi list</td></tr>
<tr><td><code>esp_blufi_get_version()</code></td><td>Get the version of the current BluFi profile</td></tr>
<tr><td><code>esp_blufi_close()</code></td><td>Disconnect the device</td></tr>
<tr><td><code>esp_blufi_send_error_info()</code></td><td>Send BluFi error messages</td></tr>
<tr><td><code>esp_blufi_send_custom_data()</code></td><td>Send custom data</td></tr>
</tbody></table>
<h3 id="program-structure-2"><a class="header" href="#program-structure-2">Program structure</a></h3>
<ul>
<li>
<p><strong>Wi-Fi event handling</strong>: taking care of Wi-Fi connection,
disconnection, reconnection, scanning, etc., as detailed in the
sections before.</p>
</li>
<li>
<p><strong>NETIF event handling</strong>: acquiring IP address. Details are provided
in the sections before.</p>
</li>
<li>
<p><strong>BluFi event handling</strong>: determined by the received request. BluFi
events are shown in Table 7.8.</p>
<p align="center"><i>Table 7.8. BluFi events</i></p>
<table><thead><tr><th>Event</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ESP_BLUFI_EVENT_INIT_FINISH</code></td><td>Initialise BluFi features, name the device, and send specified broadcast data</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_DEINIT_FINISH</code></td><td>Handle deinit configuration events</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_BLE_CONNECT</code></td><td>Connect to Bluetooth LE and put the device into safe mode</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_BLE_DISCONNECT</code></td><td>Set Bluetooth LE to disconnect and reconnect</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_SET_WIFI_OPMODE</code></td><td>Put ESP32-C3 into operating mode</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_REQ_CONNECT_TO_AP</code></td><td>Disconnect from the original Wi-Fi and connect to the specified Wi-Fi</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_REQ_DISCONNECT_FROM_AP</code></td><td>Disconnect from the AP currently connected to ESP32-C3</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_REPORT_ERROR</code></td><td>Send error messages</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_GET_WIFI_STATUS</code></td><td>Get Wi-Fi status, including the current Wi-Fi mode and whether it is connected</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_SLAVE_DISCONNECT_BLE</code></td><td>Notify BluFi that the GATT connection is closed</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_STA_BSSID</code></td><td>Enter STA mode and get the BSSID of the target AP</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_STA_SSID</code></td><td>Enter STA mode and get the SSID of the target AP</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_STA_PASSWD</code></td><td>Enter STA mode and get the password of the target AP</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_SOFTAP_SSID</code></td><td>Enter SoftAP mode and get the custom AP SSID</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_SOFTAP_PASSWD</code></td><td>Enter SoftAP mode and get the custom AP password</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_SOFTAP_MAX_CONN_NUM</code></td><td>Set the maximum number of connected devices in SoftAP mode</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_SOFTAP_AUTH_MODE</code></td><td>Enter authentication mode in SoftAP mode</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_SOFTAP_CHANNEL</code></td><td>Set the channel in SoftAP mode</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_GET_WIFI_LIST</code></td><td>Obtain the SSID list, channel, and STA MAC address scanned over the air</td></tr>
<tr><td><code>ESP_BLUFI_EVENT_RECV_CUSTOM_DATA</code></td><td>Print the received data and trim it to fit the application</td></tr>
</tbody></table>
</li>
<li>
<p><strong>Main program</strong>: initialising Wi-Fi, initialising and enabling
Bluetooth controller, initialising and enabling Bluetooth protocol,
obtaining Bluetooth address and BluFi version, processing Bluetooth
GAP events, and creating BluFi events.</p>
</li>
</ul>
<h3 id="functional-verification-2"><a class="header" href="#functional-verification-2">Functional verification</a></h3>
<p>To get started, install EspBlufi on your phone. Turn on the Wi-Fi and
power on the device. You will see the output log by the serial port as
follows:</p>
<pre><code class="language-shell">I (516) phy_init: phy_version 500,985899c,Apr 19 2021,16:05:08
I (696) wifi:set rx active PTI: 0, rx ack PTI: 12, and default PTI: 1
I (908) wifi:mode : sta (30:ae:a4:80:41:55)
I (908) wifi:enable tsf
W (706) BTDM_INIT: esp_bt_controller_mem_release not implemented, return OK
I (706) BTDM_INIT: BT controller compile version [9c99115]
I (716) coexist: coexist rom version 9387209
I (726) BTDM_INIT: Bluetooth MAC: 30:ae:a4:80:41:56
I (746) BLUFI_EXAMPLE: BD ADDR: 30:ae:a4:80:41:56
I (1198) BLUFI_EXAMPLE: BLUFI VERSION 0102
I (1198) BLUFI_EXAMPLE: BLUFI init finish
</code></pre>
<blockquote>
<p>üìå <strong>Tip</strong></p>
<p>You may download the APP at <a href="https://www.espressif.com/en/support/download/apps">https://www.espressif.com/en/support/download/apps</a>.</p>
</blockquote>
<ol>
<li>
<p><strong>Startup</strong></p>
<p>Open the application on your phone and pull down to refresh. You will
see the information about nearby Bluetooth devices on the screen as
shown in Figure 7.40.</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-40.png" width="50%">
    <figcaption>Figure 7.40. EspBlufi startup</figcaption>
</figure>
</li>
<li>
<p><strong>Connection</strong></p>
<p>Select the ESP32-C3 module BLUFI_DEVICE to get details about the device.
Tap &quot;Connect&quot; to connect with Bluetooth. If connected, you will see the
interface as Figure 7.41.</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-41.png" width="50%">
    <figcaption>Figure 7.41. Bluetooth connected</figcaption>
</figure>
<p>The output log is as follows:</p>
<pre><code class="language-shell">I (32736) BLUFI_EXAMPLE: BLUFI ble connect
</code></pre>
</li>
<li>
<p><strong>Provisioning</strong></p>
<p>Tap &quot;Provision network&quot; in Figure 7.41 to enter the provisioning
interface shown in Figure 7.42.</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-42.png" width="50%">
    <figcaption>Figure 7.42. Provisioning</figcaption>
</figure>
</li>
<li>
<p><strong>STA connection</strong></p>
<p>Tap &quot;OK&quot; in Figure 7.42 to configure the network. If the configuration
succeeds, you will see the STA connected interface shown in Figure 7.43.
Details about STA connection in Wi-Fi mode will be displayed at the
bottom of the screen, including the BSSID and SSID of the AP and the
connection status.</p>
<figure align="center">
    <img src="../../Pics/D7Z/7-43.png" width="50%">
    <figcaption>Figure 7.43. STA connected</figcaption>
</figure>
<p>The output log is as follows:</p>
<pre><code class="language-shell">I (63756) BLUFI_EXAMPLE: BLUFI Set WIFI opmode 1
I (63826) BLUFI_EXAMPLE: Recv STA SSID NETGEAR
I (63866) BLUFI_EXAMPLE: Recv STA PASSWORD 12345678
I (63936) BLUFI_EXAMPLE: BLUFI requset wifi connect to AP
I (65746) wifi:new: &lt;8,2&gt;, old: &lt;1,0&gt;, ap: &lt;255,255&gt;, sta: &lt;8,2&gt;, prof:1
I (66326) wifi:state: init -&gt; auth (b0) 
I (67326) wifi:state: auth -&gt; init (200) 
I (67326) wifi:new: &lt;8,0&gt;, old: &lt;8,2&gt;, ap: &lt;255,255&gt;, sta: &lt;8,2&gt;, prof:1 
I (69516) wifi:new: &lt;10,0&gt;, old: &lt;8,0&gt;, ap: &lt;255,255&gt;, sta: &lt;10,0&gt;, prof:1 
I (69516) wifi:state: init -&gt; auth (b0) 
I (69566) wifi:state: auth -&gt; assoc (0)
I (69626) wifi:state: assoc -&gt; run (10) 
I (69816) wifi:connected with NETGEAR, aid = 1, channel 10, BW20, bssid = 5c:02:14:03:a5:7d
I (69816) wifi:security: WPA2-PSK, phy: bgn, rssi: -48
I (69826) wifi:pm start, type: 1
I (69826) wifi:set rx beacon pti, rx_bcn_pti: 14, bcn_timeout: 14, mt_pti: 25000, mt_time: 10000
I (69926) wifi:BcnInt:102400, DTIM:1 W (70566) wifi:idx:0 (ifx:0, 5c:02:14:03:a5:7d), tid:0, ssn:2, winSize:64
I (71406) esp_netif_handlers: sta ip: 192.168.31.145, mask: 255.255.255.0, gw:192.168.31.1
</code></pre>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../../chapter_7/7.4/7.4.2.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../../chapter_7/7.5/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../../chapter_7/7.4/7.4.2.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../../chapter_7/7.5/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
